<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SuperOAuth - SystÃ¨me d'authentification</title>
    
    <!-- Styles modulaires -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸš€ SuperOAuth</h1>
            <p>SystÃ¨me d'authentification OAuth2</p>
        </div>

        <div class="dashboard">
            <!-- Dashboard Utilisateur -->
            <div class="card dashboard-section" id="userDashboard" style="display: none;">
                <div class="section-badge dashboard-badge">ğŸ‘¤ Mon Dashboard</div>
                <h3>ğŸ  Dashboard Utilisateur</h3>
                <div id="userInfo">
                    <!-- Les informations utilisateur seront injectÃ©es ici -->
                </div>
                
                <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-top: 20px;">
                    <button id="refreshUserBtn" class="btn btn-secondary">ğŸ”„ Actualiser</button>
                    <button id="logoutBtn2" class="btn btn-secondary">ğŸšª Se dÃ©connecter</button>
                </div>
                
                <div class="response-area" id="dashboardResponse" style="display: none;"></div>
            </div>

            <!-- Ã‰tat du serveur -->
            <div class="card">
                <h3>ğŸ“Š Ã‰tat du serveur</h3>
                <div class="status">
                    <div class="status-dot status-online" id="serverStatus"></div>
                    <span id="serverStatusText">En ligne - development (v1.0.0)</span>
                </div>
                <button id="checkServerBtn" class="btn">ğŸ”„ VÃ©rifier le statut</button>
                <div class="response-area" id="healthResponse" style="display: none;"></div>
            </div>

            <!-- Connexion -->
            <div class="card login-section">
                <div class="section-badge login-badge">ğŸ‘¤ Utilisateurs existants</div>
                <h3>ğŸ”‘ Connexion</h3>
                <p>Se connecter avec un compte existant</p>
                
                <div style="margin: 20px 0;">
                    <input type="email" id="loginEmail" placeholder="votre@email.com" value="" style="width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px;">
                    <input type="password" id="loginPassword" placeholder="Votre mot de passe" value="" style="width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px;">
                </div>
                
                <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                    <button id="loginBtn" class="btn btn-primary">ğŸ”‘ Se connecter</button>
                    <button id="refreshTokenBtn" class="btn btn-secondary">ğŸ”„ Refresh Token</button>
                    <button id="logoutBtn1" class="btn btn-secondary">ğŸšª Se dÃ©connecter</button>
                </div>
                
                <div class="response-area" id="loginResponse" style="display: none;"></div>
            </div>

            <!-- Inscription -->
            <div class="card register-section">
                <div class="section-badge register-badge">âœ¨ Nouveaux utilisateurs</div>
                <h3>ğŸ“ Inscription</h3>
                <p>CrÃ©er un nouveau compte utilisateur</p>
                
                <div style="margin: 20px 0;">
                    <input type="email" id="registerEmail" placeholder="nouvel@utilisateur.com" value="" style="width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px;">
                    <input type="password" id="registerPassword" placeholder="MonMotDePasse123!" value="" style="width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px;">
                    <input type="password" id="registerPasswordConfirm" placeholder="Confirmer le mot de passe" value="" style="width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px;">
                    <input type="text" id="registerNickname" placeholder="MonPseudo123" value="" style="width: 100%; padding: 10px; margin: 5px 0; border: 1px solid #ddd; border-radius: 5px;">
                </div>
                
                <div style="background: rgba(255, 193, 7, 0.1); border: 1px solid #ffc107; border-radius: 5px; padding: 10px; margin: 10px 0; font-size: 0.9em;">
                    <strong>âš ï¸ RÃ¨gles importantes :</strong><br>
                    â€¢ <strong>Email :</strong> Doit Ãªtre unique et valide<br>
                    â€¢ <strong>Mot de passe :</strong> Min. 8 caractÃ¨res avec majuscule, minuscule, chiffre et caractÃ¨re spÃ©cial<br>
                    â€¢ <strong>Confirmation :</strong> Les deux mots de passe doivent Ãªtre identiques<br>
                    â€¢ <strong>Pseudo :</strong> Doit Ãªtre unique, 3-20 caractÃ¨res (pas de mots rÃ©servÃ©s comme 'admin', 'root', etc.)
                </div>
                
                <div style="display: flex; flex-wrap: wrap; gap: 10px; justify-content: center;">
                    <button id="registerBtn" class="btn btn-success">ğŸ“ S'inscrire</button>
                    <button id="testBtn" class="btn" style="background: #ff6b6b; max-width: 120px;">ğŸ”§ Test Debug</button>
                </div>
                
                <div class="response-area" id="registerResponse" style="display: none;"></div>
            </div>

            <!-- OAuth Providers -->
            <div class="card">
                <h3>ğŸŒ Authentification OAuth</h3>
                <p>Connexion avec vos comptes sociaux</p>
                
                <div class="oauth-providers">
                    <button id="discordBtn" class="btn oauth-btn oauth-discord">
                        <span>ğŸ®</span> Discord
                    </button>
                    <button id="twitchBtn" class="btn oauth-btn oauth-twitch">
                        <span>ğŸ“º</span> Twitch
                    </button>
                    <button id="googleBtn" class="btn oauth-btn oauth-google">
                        <span>ğŸ“§</span> Google
                    </button>
                    <button id="githubBtn" class="btn oauth-btn oauth-github">
                        <span>ğŸ±</span> GitHub
                    </button>
                </div>
                
                <div class="response-area" id="oauthResponse" style="display: none;"></div>
            </div>
        </div>

        <div class="version-info">
            <h4>SuperOAuth REST API (Architecture Modulaire)</h4>
            <p><strong>Version:</strong> 1.0.0</p>
            <p><strong>Technologies:</strong> Node.js, TypeScript, Express, TypeORM, MySQL</p>
            <p><strong>Frontend:</strong> JavaScript ES6 Modules, CSS modulaire</p>
            <p><strong>Providers OAuth:</strong> Discord, Google, GitHub, Twitch</p>
            <p><strong>SÃ©curitÃ©:</strong> JWT, bcrypt, CORS, Helmet, Sessions</p>
            <p><strong>Endpoints REST:</strong> 8/8 fonctionnels (register, login, refresh, logout, oauth, callback, me, health)</p>
            <p><strong>Composants:</strong> AuthService, DashboardComponent, AuthComponent, ServerMonitor</p>
        </div>

        <div class="footer">
            <p>Â© 2025 SuperOAuth - SystÃ¨me d'authentification</p>
            <p>DÃ©veloppÃ© avec â¤ï¸ en TypeScript et JavaScript modulaire</p>
                        <div class="footer-links">
                <a href="docs/index.html" class="docs-link">ğŸ“š Documentation dÃ©veloppeur</a>
            </div>
        </div>
    </div>

    <!-- Application modulaire -->
    <script type="module" src="js/app.js"></script>
    

    
    <!-- VÃ©rification immÃ©diate du statut serveur -->
    <script>
        // VÃ©rification immÃ©diate du statut serveur (fallback)
        document.addEventListener('DOMContentLoaded', async function() {
            try {
                const response = await fetch('/health');
                const data = await response.json();
                
                const statusDot = document.getElementById('serverStatus');
                const statusText = document.getElementById('serverStatusText');
                
                if (statusDot && statusText) {
                    if (response.ok && data.status === 'ok') {
                        statusDot.className = 'status-dot status-online';
                        statusText.textContent = `En ligne - ${data.environment || 'development'} (${data.version || 'v1.0.0'})`;
                    } else {
                        statusDot.className = 'status-dot status-offline';
                        statusText.textContent = 'Hors ligne';
                    }
                }
            } catch (error) {
                console.warn('Impossible de vÃ©rifier le statut du serveur:', error);
                const statusDot = document.getElementById('serverStatus');
                const statusText = document.getElementById('serverStatusText');
                if (statusDot && statusText) {
                    statusDot.className = 'status-dot status-offline';
                    statusText.textContent = 'Erreur de connexion';
                }
            }
        });
    </script>
</body>
</html>
