<div class="content-section">
    <h1 aria-label="Tests et QualitÃ©" tabindex="0">ğŸ§ª Tests et QualitÃ©</h1>
    <p class="intro">Documentation complÃ¨te du framework de tests et de la stratÃ©gie qualitÃ© SuperOAuth.</p>
</div>

<div class="content-section">
    <h2 aria-label="Vue d'ensemble" tabindex="0">ğŸ“Š Vue d'ensemble</h2>
    <div class="info-grid">
        <div class="info-card">
            <h3>ğŸ“ˆ Frontend</h3>
            <ul>
                <li><strong>Framework:</strong> Vitest + jsdom</li>
                <li><strong>Tests:</strong> 63 tests âœ…</li>
                <li><strong>Taux de RÃ©ussite:</strong> 100%</li>
                <li><strong>Coverage:</strong> V8 provider (60%)</li>
            </ul>
        </div>
        <div class="info-card">
            <h3>ğŸ—ï¸ Backend</h3>
            <ul>
                <li><strong>Framework:</strong> Jest + ts-jest</li>
                <li><strong>Tests:</strong> 30 tests âœ…</li>
                <li><strong>Taux de RÃ©ussite:</strong> 100%</li>
                <li><strong>Coverage:</strong> 11.94% (focus domaine)</li>
            </ul>
        </div>
        <div class="info-card">
            <h3>ğŸ“Š Total</h3>
            <ul>
                <li><strong>Tests Total:</strong> 93 tests</li>
                <li><strong>Suites:</strong> 7 modules</li>
                <li><strong>Frameworks:</strong> 2 (Vitest + Jest)</li>
                <li><strong>Statut Global:</strong> âœ… 100%</li>
            </ul>
        </div>
    </div>
</div>

<div class="content-section">
    <h2 aria-label="Quick Start" tabindex="0">ğŸš€ Quick Start</h2>
    <div class="code-block">
        <h3>Commandes Essentielles</h3>
        <pre><code># Tests frontend complets
npm run test:frontend

# Tests backend complets
npm run test

# Tous les tests (frontend + backend)
npm run test:all

# Mode dÃ©veloppement (watch)
npm run test:frontend:watch
npm run test:watch

# Interface graphique (frontend)
npm run test:frontend:ui

# Rapports de couverture
npm run test:frontend:coverage
npm run test:coverage
npm run test:all:coverage

# GÃ©nÃ©ration rapport complet
npm run report:tests</code></pre>
    </div>
</div>

<div class="content-section">
    <h2 aria-label="StratÃ©gie de Tests" tabindex="0">ğŸ¯ StratÃ©gie de Tests</h2>
    
    <h3>Classification des Tests</h3>
    <div class="info-grid">
        <div class="info-card critical">
            <h4>ğŸ”´ Tests Critiques (32)</h4>
            <ul>
                <li>Authentification et sÃ©curitÃ©</li>
                <li>Validation des donnÃ©es</li>
                <li>Logique mÃ©tier principale</li>
                <li>Gestion des erreurs critiques</li>
            </ul>
            <div class="percentage">51% des tests</div>
        </div>
        
        <div class="info-card performance">
            <h4>ğŸŸ¡ Tests Performance (18)</h4>
            <ul>
            <h3 class="accordion-header" aria-label="Backend Use Cases (5 tests)" tabindex="0">ğŸ—ï¸ Backend Use Cases (5 tests)</h3>
                <li>Optimisations de rendu</li>
                <li>Gestion du cache</li>
                <li>ExpÃ©rience utilisateur</li>
            </ul>
            <div class="percentage">29% des tests</div>
        </div>
        
        <div class="info-card robustness">
            <h4>ğŸŸ¢ Tests Robustesse (13)</h4>
            <ul>
                <li>Cas limites et edge cases</li>
                <li>RÃ©cupÃ©ration d'erreurs</li>
                <li>RÃ©silience rÃ©seau</li>
                <li>Validation entrÃ©es</li>
            </ul>
            <div class="percentage">20% des tests</div>
        </div>
    </div>
</div>

<div class="content-section">
    <h2>ğŸ—ï¸ Tests Backend (Jest)</h2>
    
    <div class="info-grid">
        <div class="info-card">
            <h3>ğŸ“‹ Value Objects (7 tests)</h3>
            <ul>
                <li><strong>UserId</strong> : GÃ©nÃ©ration/validation UUID</li>
                <li><strong>Email</strong> : Validation/normalisation</li>
                <li><strong>Password</strong> : Hachage/vÃ©rification</li>
                <li><strong>Nickname</strong> : Validation format</li>
            </ul>
            <div class="percentage">Tests domaine critique</div>
        </div>
        
        <div class="info-card">
            <h3>ğŸ”§ Use Cases (5 tests)</h3>
            <ul>
                <li><strong>Register Classic</strong> : Inscription email/password</li>
                <li>Validation donnÃ©es utilisateur</li>
                <li>Gestion erreurs mÃ©tier</li>
                <li>GÃ©nÃ©ration tokens</li>
            </ul>
            <div class="percentage">Logique mÃ©tier</div>
        </div>
        
        <div class="info-card">
            <h3>ğŸ› ï¸ Services (18 tests)</h3>
            <ul>
                <li><strong>Token Service</strong> : JWT complet</li>
                <li>GÃ©nÃ©ration access/refresh tokens</li>
                <li>VÃ©rification signatures</li>
                <li>Gestion expirations</li>
            </ul>
            <div class="percentage">Infrastructure</div>
        </div>
    </div>
</div>

<div class="content-section">
    <h2>ğŸ§© DÃ©tails par Composant</h2>
    
    <div class="accordion">
        <div class="accordion-item">
            <h3 class="accordion-header">ğŸ—ï¸ Backend Value Objects (7 tests)</h3>
            <div class="accordion-content">
                <h4>UserId Tests (4)</h4>
                <ul>
                    <li>âœ… GÃ©nÃ©ration UUID v4 valide</li>
                    <li>âœ… Acceptation UUID valide</li>
                    <li>âœ… Rejet UUID invalide</li>
                    <li>âœ… Ã‰galitÃ© entre instances</li>
                </ul>
                
                <h4>Email Tests (3)</h4>
                <ul>
                    <li>âœ… Validation format email</li>
                    <li>âœ… Normalisation en minuscules</li>
                    <li>âœ… Extraction domaine</li>
                </ul>
                
                <h4>Password Tests (4)</h4>
                <ul>
                    <li>âœ… Hachage bcrypt sÃ©curisÃ©</li>
                    <li>âœ… VÃ©rification mot de passe</li>
                    <li>âœ… Rejet mots de passe faibles</li>
                </ul>
                
                <h4>Nickname Tests (4)</h4>
                <ul>
                    <li>âœ… Validation format alphanumeric</li>
                    <li>âœ… Rejet caractÃ¨res spÃ©ciaux</li>
                    <li>âœ… Limite longueur (32 chars)</li>
                </ul>
            </div>
        </div>
        
        <div class="accordion-item">
            <h3 class="accordion-header">ï¿½ Backend Use Cases (5 tests)</h3>
            <div class="accordion-content">
                <h4>Register Classic Use Case</h4>
                <ul>
                    <li>âœ… Inscription utilisateur valide</li>
                    <li>âœ… PrÃ©vention doublons email</li>
                    <li>âœ… Validation format email</li>
                    <li>âœ… Rejet mots de passe faibles</li>
                    <li>âœ… GÃ©nÃ©ration tokens automatique</li>
                </ul>
                
                <div class="code-block">
                    <h5>Exemple Test</h5>
                    <pre><code>it('should register a new user successfully', async () => {
  const dto = {
    email: 'test@example.com',
    password: 'Test123!@#',
    nickname: 'testuser'
  };
  
  const result = await useCase.execute(dto);
  
  expect(result.accessToken).toBeDefined();
  expect(result.user.email).toBe('test@example.com');
});</code></pre>
                </div>
            </div>
        </div>
        
        <div class="accordion-item">
            <h3 class="accordion-header">ğŸ”‘ Backend Token Service (18 tests)</h3>
            <div class="accordion-content">
                <h4>Access Token Tests (4)</h4>
                <ul>
                    <li>âœ… GÃ©nÃ©ration token valide</li>
                    <li>âœ… Format JWT correct (3 parties)</li>
                    <li>âœ… Tokens uniques par utilisateur</li>
                    <li>âœ… VÃ©rification signature</li>
                </ul>
                
                <h4>Refresh Token Tests (3)</h4>
                <ul>
                    <li>âœ… GÃ©nÃ©ration token refresh</li>
                    <li>âœ… UnicitÃ© des tokens</li>
                    <li>âœ… DurÃ©e de vie configurÃ©e</li>
                </ul>
                
                <h4>Validation Tests (8)</h4>
                <ul>
                    <li>âœ… VÃ©rification tokens valides</li>
                    <li>âœ… Rejet tokens invalides</li>
                    <li>âœ… Gestion tokens vides</li>
                    <li>âœ… Extraction donnÃ©es utilisateur</li>
                </ul>
                
                <h4>Configuration Tests (3)</h4>
                <ul>
                    <li>âœ… Calcul expirations correctes</li>
                    <li>âœ… Validation secrets production</li>
                    <li>âœ… Gestion erreurs format</li>
                </ul>
                
                <div class="code-block">
                    <h5>Configuration JWT</h5>
                    <pre><code># Variables d'environnement requises
JWT_ACCESS_SECRET=your-secret-key
JWT_REFRESH_SECRET=your-refresh-secret
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d</code></pre>
                </div>
            </div>
        </div>
        
        <div class="accordion-item">
            <h3 class="accordion-header">ï¿½ğŸ” Frontend Auth Service (15 tests)</h3>
            <div class="accordion-content">
                <h4>Tests Critiques (9)</h4>
                <ul>
                    <li>âœ… Login avec credentials valides</li>
                    <li>âœ… Login avec credentials invalides</li>
                    <li>âœ… Register avec donnÃ©es valides</li>
                    <li>âœ… Register avec email existant</li>
                    <li>âœ… Logout utilisateur</li>
                    <li>âœ… Refresh token valide/expirÃ©</li>
                    <li>âœ… VÃ©rification token</li>
                    <li>âœ… Validation email format</li>
                </ul>
                
                <h4>Tests Performance (3)</h4>
                <ul>
                    <li>âœ… Cache des rÃ©ponses</li>
                    <li>âœ… Timeout requests</li>
                    <li>âœ… Retry automatique</li>
                </ul>
                
                <h4>Tests Robustesse (3)</h4>
                <ul>
                    <li>âœ… Gestion erreurs rÃ©seau</li>
                    <li>âœ… RÃ©ponses malformÃ©es</li>
                    <li>âœ… Ã‰tats concurrents</li>
                </ul>
            </div>
        </div>
        
        <div class="accordion-item">
            <h3 class="accordion-header">ğŸ“Š Dashboard Component (15 tests)</h3>
            <div class="accordion-content">
                <h4>Tests Critiques (8)</h4>
                <ul>
                    <li>âœ… Chargement donnÃ©es utilisateur</li>
                    <li>âœ… Affichage informations</li>
                    <li>âœ… Gestion Ã©tats de charge</li>
                    <li>âœ… Navigation entre sections</li>
                    <li>âœ… Actions utilisateur</li>
                    <li>âœ… Validation formulaires</li>
                    <li>âœ… Gestion permissions</li>
                    <li>âœ… Mise Ã  jour temps rÃ©el</li>
                </ul>
                
                <h4>Tests UX (4)</h4>
                <ul>
                    <li>âœ… Animations et transitions</li>
                    <li>âœ… Responsive design</li>
                    <li>âœ… Feedback visuel</li>
                    <li>âœ… AccessibilitÃ©</li>
                </ul>
                
                <h4>Tests Performance (3)</h4>
                <ul>
                    <li>âœ… Lazy loading composants</li>
                    <li>âœ… Cache donnÃ©es</li>
                    <li>âœ… Optimisation rendu</li>
                </ul>
            </div>
        </div>
        
        <div class="accordion-item">
            <h3 class="accordion-header">ğŸ“¡ Server Monitor (15 tests)</h3>
            <div class="accordion-content">
                <h4>Tests Critiques (8)</h4>
                <ul>
                    <li>âœ… Status serveur</li>
                    <li>âœ… MÃ©triques temps rÃ©el</li>
                    <li>âœ… Alertes systÃ¨me</li>
                    <li>âœ… Historique mÃ©triques</li>
                    <li>âœ… Seuils d'alerte</li>
                    <li>âœ… Connexion base donnÃ©es</li>
                    <li>âœ… Services externes</li>
                    <li>âœ… Logs systÃ¨me</li>
                </ul>
                
                <h4>Tests Performance (4)</h4>
                <ul>
                    <li>âœ… Polling optimisÃ©</li>
                    <li>âœ… Compression donnÃ©es</li>
                    <li>âœ… Cache mÃ©triques</li>
                    <li>âœ… Batch updates</li>
                </ul>
                
                <h4>Tests Robustesse (3)</h4>
                <ul>
                    <li>âœ… Reconnexion automatique</li>
                    <li>âœ… Fallback modes</li>
                    <li>âœ… Error recovery</li>
                </ul>
            </div>
        </div>
        
        <div class="accordion-item">
            <h3 class="accordion-header">ğŸ› ï¸ Shared Utils (18 tests)</h3>
            <div class="accordion-content">
                <p><strong>Tests Utilitaires complets couvrant :</strong></p>
                <div class="utils-grid">
                    <div class="utils-category">
                        <h5>Formatage</h5>
                        <ul>
                            <li>âœ… Formatage dates</li>
                            <li>âœ… Number formatting</li>
                            <li>âœ… Error formatting</li>
                        </ul>
                    </div>
                    <div class="utils-category">
                        <h5>Validation</h5>
                        <ul>
                            <li>âœ… Validation email</li>
                            <li>âœ… Sanitization HTML</li>
                            <li>âœ… URL parsing</li>
                        </ul>
                    </div>
                    <div class="utils-category">
                </div>
                <div class="utils-details">
                    <h4>ğŸ§ª Tests unitaires spÃ©cifiques â€“ <code>analyze-bundle-size.js</code></h4>
                    <p>Des tests unitaires couvrent les fonctions utilitaires critiques du script dâ€™analyse de bundles&nbsp;:</p>
                    <ul>
                        <li><b>formatBytes</b>Â : VÃ©rifie le formatage lisible des tailles (octets, Ko, Mo, etc.).</li>
                        <li><b>getPerformanceScore</b>Â : Calcule un score de performance selon la taille du bundle.</li>
                        <li><b>getPerformanceRating</b>Â : Retourne une apprÃ©ciation textuelle (excellent, good, average, poor).</li>
                        <li><b>getPerformanceEmoji</b>Â : Associe un emoji au score de performance.</li>
                        <li><b>getPerformanceClass</b>Â : Retourne la classe CSS pour affichage visuel du score.</li>
                    </ul>
                    <div class="code-block">
                        <h5>Exemples de tests</h5>
                        <pre><code>expect(formatBytes(1536)).toBe('1.5 KB');
                        <h5>Stockage</h5>
                        <ul>
                            <li>âœ… Local storage</li>
                            <li>âœ… Session storage</li>
                            <li>âœ… Gestion cookies</li>
                    </div>
                    <p>Ces tests garantissent la fiabilitÃ© des indicateurs affichÃ©s dans les rapports dâ€™analyse de bundles.</p>
                </div>
                        </ul>
                    </div>
                    <div class="utils-category">
                        <h5>Performance</h5>
                        <ul>
                            <li>âœ… Debounce functions</li>
                            <li>âœ… Throttle functions</li>
                            <li>âœ… Deep clone objects</li>
                        </ul>
                    </div>
                    <div class="utils-category">
                        <h5>SÃ©curitÃ©</h5>
                        <ul>
                            <li>âœ… Cryptage client</li>
                            <li>âœ… GÃ©nÃ©ration UUID</li>
                        </ul>
                    </div>
                    <div class="utils-category">
                        <h5>Fichiers</h5>
                        <ul>
                            <li>âœ… File upload</li>
                            <li>âœ… Image processing</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="content-section">
    <h2>âš™ï¸ Configuration Technique</h2>
    
    <h3>Configuration Vitest</h3>
    <div class="code-block">
        <pre><code>// vitest.config.js
export default defineConfig({
  test: {
    globals: true,                    // APIs globales
    environment: 'jsdom',             // Simulation DOM
    setupFiles: ['./tests/frontend/setup.js'],
    coverage: {
      provider: 'v8',                 // Engine V8
      thresholds: {
        global: {
          branches: 60,               // 60% minimum
          functions: 60,
          lines: 60,
          statements: 60
        }
      }
    }
  }
});</code></pre>
    </div>
    
    <h3>Mocks Disponibles</h3>
    <div class="info-grid">
        <div class="info-card">
            <h4>Browser APIs</h4>
            <ul>
                <li>localStorage/sessionStorage</li>
                <li>fetch API</li>
                <li>clipboard API</li>
                <li>DOM manipulation</li>
            </ul>
        </div>
        <div class="info-card">
            <h4>API Responses</h4>
            <ul>
                <li>Health checks</li>
                <li>Authentication flows</li>
                <li>User profiles</li>
                <li>Error scenarios</li>
            </ul>
        </div>
    </div>
</div>

<div class="content-section">
    <h2>ğŸ“ˆ Roadmap Tests</h2>
    
    <div class="roadmap">
        <div class="roadmap-item completed">
            <h3>âœ… Phase 3.1 - Tests Frontend</h3>
            <ul>
                <li>Framework Vitest configurÃ©</li>
                <li>63 tests frontend implÃ©mentÃ©s</li>
                <li>Mocks complets</li>
                <li>Documentation intÃ©grÃ©e</li>
            </ul>
        </div>
        
        <div class="roadmap-item next">
            <h3>ğŸ”„ Phase 3.2 - Tests Backend</h3>
            <ul>
                <li>Tests unitaires (Jest/Vitest)</li>
                <li>Tests d'intÃ©gration (Supertest)</li>
                <li>Tests base de donnÃ©es</li>
                <li>Tests API complets</li>
            </ul>
        </div>
        
        <div class="roadmap-item future">
            <h3>ğŸ”® Phase 3.3 - Tests E2E</h3>
            <ul>
                <li>Playwright/Cypress</li>
                <li>ScÃ©narios utilisateur complets</li>
                <li>Tests cross-browser</li>
                <li>Tests d'accessibilitÃ©</li>
            </ul>
        </div>
        
        <div class="roadmap-item future">
            <h3>ğŸ”® Phase 3.4 - Tests Performance</h3>
            <ul>
                <li>Tests de charge (k6/Artillery)</li>
                <li>Benchmarks API</li>
                <li>Monitoring continu</li>
                <li>Regression testing</li>
            </ul>
        </div>
    </div>
</div>

<div class="content-section">
    <h2>ğŸ›¡ï¸ Bonnes Pratiques</h2>
    
    <div class="best-practices">
        <div class="practice-category">
            <h3>ğŸ“ Ã‰criture de Tests</h3>
            <ul>
                <li><strong>Noms descriptifs</strong> : Tests auto-documentÃ©s</li>
                <li><strong>Structure AAA</strong> : Arrange-Act-Assert</li>
                <li><strong>Tests atomiques</strong> : Un concept par test</li>
                <li><strong>Mocks rÃ©alistes</strong> : DonnÃ©es proches rÃ©alitÃ©</li>
            </ul>
        </div>
        
        <div class="practice-category">
            <h3>ğŸƒ ExÃ©cution</h3>
            <ul>
                <li><strong>Tests rapides</strong> : &lt; 10s pour suite complÃ¨te</li>
                <li><strong>Tests dÃ©terministes</strong> : Pas de flaky tests</li>
                <li><strong>Isolation</strong> : Tests indÃ©pendants</li>
                <li><strong>Cleanup</strong> : Nettoyage entre tests</li>
            </ul>
        </div>
        
        <div class="practice-category">
            <h3>ğŸ“Š Maintenance</h3>
            <ul>
                <li><strong>Coverage monitoring</strong> : Seuils respectÃ©s</li>
                <li><strong>Documentation Ã  jour</strong> : Tests documentÃ©s</li>
                <li><strong>Refactoring rÃ©gulier</strong> : Code de test propre</li>
                <li><strong>CI/CD integration</strong> : Tests automatisÃ©s</li>
            </ul>
        </div>
        <div class="practice-category">
            <h3>ğŸ›¡ï¸ Gestion dâ€™erreur explicite</h3>
            <ul>
                <li>Le script <code>analyze-bundle-size.js</code> affiche systÃ©matiquement le chemin du fichier concernÃ© lors dâ€™une erreur de lecture ou dâ€™Ã©criture (bundles, config, rapportsâ€¦).</li>
                <li>Permet un diagnostic rapide en cas de problÃ¨me dâ€™accÃ¨s aux fichiers.</li>
            </ul>
        </div>
    </div>
</div>

<div class="content-section">
    <h2>ğŸ”§ Debugging et Troubleshooting</h2>
    
    <div class="code-block">
        <h3>Commandes de Debug</h3>
        <pre><code># Debug un test spÃ©cifique
npx vitest auth-service --inspect-brk

# Tests avec pattern
npx vitest --grep "login"

# Verbose output
npx vitest --reporter=verbose

# Interface graphique
npm run test:frontend:ui</code></pre>
    </div>
    
    <div class="troubleshooting">
        <h3>ProblÃ¨mes Courants</h3>
        <div class="problem-solution">
            <h4>âŒ Tests flaky</h4>
            <p><strong>Solution :</strong> VÃ©rifier les mocks, ajouter await appropriÃ©s, isoler les tests</p>
        </div>
        
        <div class="problem-solution">
            <h4>âŒ Coverage insuffisant</h4>
            <p><strong>Solution :</strong> Identifier les lignes non couvertes, ajouter tests manquants</p>
        </div>
        
        <div class="problem-solution">
            <h4>âŒ Tests lents</h4>
            <p><strong>Solution :</strong> Optimiser les mocks, parallÃ©liser si possible</p>
        </div>
    </div>
</div>
