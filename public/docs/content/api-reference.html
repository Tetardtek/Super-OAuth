<div class="content-section">
<h2>üîå API Reference</h2>

<h3>üåê Endpoints disponibles</h3>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode POST" tabindex="0">POST</span>
        <span aria-label="Endpoint /auth/register" tabindex="0">/auth/register</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> Inscription d'un nouvel utilisateur avec email et mot de passe</p>
        <div class="code-block">// Param√®tres requis
{
  "email": "user@example.com",
  "password": "SecurePassword123!",
  "nickname": "MonPseudo"
}

// R√©ponse succ√®s (201 Created)
{
  "success": true,
  "message": "User registered successfully",
  "data": {
    "user": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "email": "user@example.com",
      "nickname": "MonPseudo",
      "emailVerified": false,
      "isActive": true,
      "createdAt": "2025-11-18T10:30:00Z"
    },
    "tokens": {
      "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    }
  }
}

// R√©ponse erreur - Email d√©j√† utilis√© (409 Conflict)
{
  "success": false,
  "error": "USER_EXISTS",
  "message": "User with this email already exists"
}

// R√©ponse erreur - Validation (400 Bad Request)
{
  "success": false,
  "error": "VALIDATION_ERROR",
  "message": "Password must be at least 8 characters with uppercase, lowercase, numbers and special characters"
}</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode POST" tabindex="0">POST</span>
        <span aria-label="Endpoint /auth/login" tabindex="0">/auth/login</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> Connexion utilisateur avec email et mot de passe</p>
        <div class="code-block">// Param√®tres requis
{
  "email": "user@example.com",
  "password": "SecurePassword123!"
}

// R√©ponse succ√®s (200 OK)
{
  "success": true,
  "message": "Login successful",
  "data": {
    "user": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "email": "user@example.com",
      "nickname": "MonPseudo",
      "emailVerified": false,
      "isActive": true,
      "linkedProviders": ["discord", "google"],
      "lastLoginAt": "2025-11-18T10:30:00Z",
      "loginCount": 5
    },
    "tokens": {
      "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
      "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
    }
  }
}

// R√©ponse erreur - Credentials invalides (401 Unauthorized)
{
  "success": false,
  "error": "INVALID_CREDENTIALS",
  "message": "Invalid email or password"
}

// R√©ponse erreur - Compte d√©sactiv√© (403 Forbidden)
{
  "success": false,
  "error": "ACCOUNT_DISABLED",
  "message": "Account is disabled"
}</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode GET" tabindex="0">GET</span>
        <span aria-label="Endpoint /auth/me" tabindex="0">/auth/me</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> R√©cup√©ration des informations de l'utilisateur connect√©</p>
        <div class="code-block">// Headers requis
Authorization: Bearer {accessToken}

// R√©ponse succ√®s (200 OK)
{
  "success": true,
  "data": {
    "user": {
      "id": "550e8400-e29b-41d4-a716-446655440000",
      "email": "user@example.com",
      "nickname": "MonPseudo",
      "emailVerified": false,
      "isActive": true,
      "linkedProviders": ["discord", "google"],
      "createdAt": "2025-11-18T10:30:00Z",
      "lastLogin": "2025-11-18T14:25:00Z",
      "loginCount": 5
    }
  }
}

// R√©ponse erreur - Token invalide (401 Unauthorized)
{
  "success": false,
  "error": "INVALID_TOKEN",
  "message": "Invalid or expired access token"
}</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode POST" tabindex="0">POST</span>
        <span aria-label="Endpoint /auth/refresh" tabindex="0">/auth/refresh</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> Rafra√Æchir l'access token avec un refresh token valide</p>
        <div class="code-block">// Param√®tres requis
{
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}

// R√©ponse succ√®s (200 OK)
{
  "success": true,
  "message": "Token refreshed successfully",
  "data": {
    "accessToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
  }
}

// R√©ponse erreur - Refresh token invalide (401 Unauthorized)
{
  "success": false,
  "error": "INVALID_REFRESH_TOKEN",
  "message": "Invalid or expired refresh token"
}</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode POST" tabindex="0">POST</span>
        <span aria-label="Endpoint /auth/logout" tabindex="0">/auth/logout</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> D√©connexion et r√©vocation des tokens</p>
        <div class="code-block">// Headers requis
Authorization: Bearer {accessToken}

// Param√®tres optionnels
{
  "refreshToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..." // Optionnel
}

// R√©ponse succ√®s (200 OK)
{
  "success": true,
  "message": "Logout successful"
}

// Note : Si refreshToken non fourni, d√©connexion de toutes les sessions</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode GET" tabindex="0">GET</span>
        <span aria-label="Endpoint /health" tabindex="0">/health</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> V√©rification du statut du serveur (health check)</p>
        <div class="code-block">// Pas d'authentification requise

// R√©ponse succ√®s (200 OK)
{
  "status": "ok",
  "timestamp": "2025-11-18T10:30:00Z",
  "version": "1.0.0",
  "environment": "production",
  "message": "SuperOAuth API is running"
}</div>
    </div>
</div>

<h3>üîê Authentification</h3>
<p>L'API utilise des tokens JWT pour l'authentification. Incluez le token dans le header Authorization :</p>
<div class="code-block">Authorization: Bearer {votre_token_jwt}</div>

<h3>üìä Codes de r√©ponse</h3>
<ul>
    <li><span class="badge success">200</span> Succ√®s</li>
    <li><span class="badge info">201</span> Cr√©√© avec succ√®s</li>
    <li><span class="badge warning">400</span> Erreur de validation</li>
    <li><span class="badge danger">401</span> Non authentifi√©</li>
    <li><span class="badge danger">403</span> Acc√®s refus√©</li>
    <li><span class="badge danger">500</span> Erreur serveur</li>
</ul>

<h3>üåê Endpoints OAuth</h3>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode GET" tabindex="0">GET</span>
        <span aria-label="Endpoint /api/v1/oauth/providers" tabindex="0">/api/v1/oauth/providers</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> Liste tous les providers OAuth disponibles</p>
        <div class="code-block">// Pas d'authentification requise

// R√©ponse succ√®s (200 OK)
{
  "success": true,
  "data": {
    "providers": [
      {
        "name": "discord",
        "displayName": "Discord",
        "enabled": true,
        "authUrl": "/api/v1/oauth/discord"
      },
      {
        "name": "google",
        "displayName": "Google",
        "enabled": true,
        "authUrl": "/api/v1/oauth/google"
      },
      {
        "name": "github",
        "displayName": "GitHub",
        "enabled": true,
        "authUrl": "/api/v1/oauth/github"
      },
      {
        "name": "twitch",
        "displayName": "Twitch",
        "enabled": true,
        "authUrl": "/api/v1/oauth/twitch"
      }
    ]
  }
}</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode GET" tabindex="0">GET</span>
        <span aria-label="Endpoint /api/v1/oauth/:provider" tabindex="0">/api/v1/oauth/:provider</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> Initialisation du flux OAuth pour un provider</p>
        <div class="code-block">// Providers support√©s : discord, google, github, twitch
// Pas d'authentification requise pour nouveau compte
// Authentification optionnelle pour lier un provider √† un compte existant

// Exemple : GET /api/v1/oauth/discord
// Redirige automatiquement vers la page d'autorisation du provider

// Headers optionnels pour lier un compte existant
Authorization: Bearer {accessToken}

// R√©ponse : Redirection 302 vers l'URL d'autorisation du provider</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode GET" tabindex="0">GET</span>
        <span aria-label="Endpoint /api/v1/oauth/:provider/callback" tabindex="0">/api/v1/oauth/:provider/callback</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> Callback OAuth automatique apr√®s autorisation</p>
        <div class="code-block">// URL de callback configur√©e chez chaque provider
// G√©r√©e automatiquement par le serveur

// Param√®tres re√ßus automatiquement
?code=authorization_code&state=random_state

// Cas 1: Nouveau compte ou connexion existante
// ‚Üí Redirection vers /dashboard avec tokens
// ‚Üí URL: /dashboard?access_token=...&refresh_token=...

// Cas 2: Liaison √† un compte existant (utilisateur d√©j√† connect√©)
// ‚Üí Redirection vers /dashboard avec message de succ√®s
// ‚Üí Le provider est ajout√© √† linkedProviders de l'utilisateur

// Cas 3: Erreur
// ‚Üí Redirection vers /login avec message d'erreur
// ‚Üí URL: /login?error=...</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode GET" tabindex="0">GET</span>
        <span aria-label="Endpoint /api/v1/oauth/linked" tabindex="0">/api/v1/oauth/linked</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> R√©cup√®re la liste des providers li√©s au compte de l'utilisateur connect√©</p>
        <div class="code-block">// Headers requis
Authorization: Bearer {accessToken}

// R√©ponse succ√®s (200 OK)
{
  "success": true,
  "data": {
    "linkedProviders": [
      {
        "provider": "discord",
        "providerId": "123456789012345678",
        "email": "user@example.com",
        "linkedAt": "2025-11-15T10:30:00Z"
      },
      {
        "provider": "google",
        "providerId": "google-user-id-123",
        "email": "user@gmail.com",
        "linkedAt": "2025-11-16T14:20:00Z"
      }
    ]
  }
}

// R√©ponse erreur - Non authentifi√© (401 Unauthorized)
{
  "success": false,
  "error": "INVALID_TOKEN",
  "message": "Invalid or expired access token"
}</div>
    </div>
</div>

<div class="endpoint">
    <div class="endpoint-header">
        <span class="method" aria-label="M√©thode DELETE" tabindex="0">DELETE</span>
        <span aria-label="Endpoint /api/v1/oauth/:provider/unlink" tabindex="0">/api/v1/oauth/:provider/unlink</span>
    </div>
    <div class="endpoint-body">
        <p><strong>Description :</strong> D√©lier un provider OAuth du compte utilisateur</p>
        <div class="code-block">// Headers requis
Authorization: Bearer {accessToken}

// Exemple : DELETE /api/v1/oauth/discord/unlink

// R√©ponse succ√®s (200 OK)
{
  "success": true,
  "message": "Provider unlinked successfully",
  "data": {
    "provider": "discord",
    "remainingProviders": ["google"]
  }
}

// R√©ponse erreur - Provider non li√© (404 Not Found)
{
  "success": false,
  "error": "PROVIDER_NOT_LINKED",
  "message": "This provider is not linked to your account"
}

// R√©ponse erreur - Dernier provider (400 Bad Request)
{
  "success": false,
  "error": "CANNOT_UNLINK_LAST_PROVIDER",
  "message": "Cannot unlink last authentication method. Add another provider or set a password first."
}</div>
    </div>
</div>

<h3>üìã Providers OAuth Support√©s</h3>
<ul>
    <li><strong>Discord</strong> - Authentification via Discord</li>
    <li><strong>Google</strong> - Authentification via compte Google</li>
    <li><strong>GitHub</strong> - Authentification via compte GitHub</li>
    <li><strong>Twitch</strong> - Authentification via compte Twitch</li>
</ul>

<h3>üîó URLs de Callback</h3>
<p>URLs √† configurer dans les consoles d√©veloppeurs des providers :</p>
<div class="code-block">Discord:  http://localhost:3000/api/v1/oauth/discord/callback
Google:   http://localhost:3000/api/v1/oauth/google/callback
GitHub:   http://localhost:3000/api/v1/oauth/github/callback
Twitch:   http://localhost:3000/api/v1/oauth/twitch/callback

Production: Remplacer localhost:3000 par votre domaine</div>

