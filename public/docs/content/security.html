<h2 aria-label="Guide de SÃ©curitÃ© SuperOAuth" tabindex="0">ğŸ”’ Guide de SÃ©curitÃ© SuperOAuth</h2>

<div class="security-overview">
    <p>SuperOAuth implÃ©mente une approche de sÃ©curitÃ© en profondeur avec plusieurs couches de protection pour garantir la confidentialitÃ© et l'intÃ©gritÃ© des donnÃ©es utilisateur.</p>
</div>

<div class="security-status">
    <div class="status-item active">
        <span class="status-icon">ğŸ›¡ï¸</span>
        <span>Authentification Forte</span>
    </div>
    <div class="status-item active">
        <span class="status-icon">ğŸ”</span>
        <span>Tokens JWT SÃ©curisÃ©s</span>
    </div>
    <div class="status-item active">
        <span class="status-icon">ğŸŒ</span>
        <span>Protection Web CSP</span>
    </div>
    <div class="status-item active">
        <span class="status-icon">ğŸ”</span>
        <span>Validation Stricte</span>
    </div>
</div>

<h3 aria-label="Authentification" tabindex="0">ğŸ” Authentification</h3>

<div class="security-section">
    <h4 aria-label="Hachage des Mots de Passe" tabindex="0">ğŸ—ï¸ Hachage des Mots de Passe</h4>
    <div class="code-block">import * as bcrypt from 'bcrypt';

class PasswordService {
  private static readonly SALT_ROUNDS = 12;

  static async hash(password: string): Promise&lt;string&gt; {
    return bcrypt.hash(password, this.SALT_ROUNDS);
  }

  static async verify(password: string, hash: string): Promise&lt;boolean&gt; {
    return bcrypt.compare(password, hash);
  }
}</div>

    <div class="component-card">
        <h5 aria-label="Politique de Mots de Passe" tabindex="0">ğŸ”’ Politique de Mots de Passe</h5>
        <ul>
            <li><strong>Minimum 8 caractÃ¨res</strong></li>
            <li><strong>Au moins 1 minuscule</strong> (a-z)</li>
            <li><strong>Au moins 1 majuscule</strong> (A-Z)</li>
            <li><strong>Au moins 1 chiffre</strong> (0-9)</li>
            <li><strong>Au moins 1 caractÃ¨re spÃ©cial</strong> (@$!%*?&)</li>
        </ul>
    </div>
</div>

<div class="security-section">
    <h4 aria-label="Protection contre les Attaques" tabindex="0">ğŸ›¡ï¸ Protection contre les Attaques</h4>
    
    <div class="code-block">// Rate Limiting - Limitation des tentatives
const loginLimiter = rateLimit({
  windowMs: 15 * 60 * 1000, // 15 minutes
  max: 5, // Maximum 5 tentatives
  message: 'Trop de tentatives de connexion',
  standardHeaders: true,
  legacyHeaders: false,
});</div>

    <div class="attack-protection-grid">
        <div class="protection-card">
            <h5 aria-label="Brute Force" tabindex="0">ğŸš« Brute Force</h5>
            <p>Limitation Ã  5 tentatives par 15 minutes</p>
        </div>
        <div class="protection-card">
            <h5 aria-label="Lockout Temporaire" tabindex="0">ğŸ• Lockout Temporaire</h5>
            <p>Blocage de 30 minutes aprÃ¨s Ã©checs rÃ©pÃ©tÃ©s</p>
        </div>
        <div class="protection-card">
            <h5 aria-label="Monitoring" tabindex="0">ğŸ“Š Monitoring</h5>
            <p>Surveillance des tentatives d'intrusion</p>
        </div>
    </div>
</div>

<h3 aria-label="SÃ©curitÃ© Web" tabindex="0">ğŸŒ SÃ©curitÃ© Web</h3>

<div class="security-section">
    <h4 aria-label="Content Security Policy (CSP)" tabindex="0">ğŸ”’ Content Security Policy (CSP)</h4>
    <div class="code-block">app.use(helmet({
  contentSecurityPolicy: {
    directives: {
      defaultSrc: ["'self'"],
      scriptSrc: ["'self'"],
      scriptSrcAttr: ["'none'"], // Bloque les onclick inline
      styleSrc: ["'self'", "'unsafe-inline'"],
      imgSrc: ["'self'", "data:", "https:"],
      connectSrc: ["'self'"],
      fontSrc: ["'self'"],
      objectSrc: ["'none'"],
      mediaSrc: ["'self'"],
      frameSrc: ["'none'"],
    },
  },
}));</div>

    <div class="csp-impact">
        <div class="impact-example bad">
            <h5>âŒ BloquÃ© par CSP</h5>
            <div class="code-block">&lt;button onclick="myFunction()"&gt;Click&lt;/button&gt;</div>
        </div>
        <div class="impact-example good">
            <h5>âœ… AutorisÃ© par CSP</h5>
            <div class="code-block">document.getElementById('button').addEventListener('click', myFunction);</div>
        </div>
    </div>
</div>

<div class="security-section">
    <h4>ğŸ›¡ï¸ Headers de SÃ©curitÃ©</h4>
    <div class="security-headers-grid">
        <div class="header-card">
            <h5>ğŸš« X-Frame-Options</h5>
            <p>Protection contre le clickjacking</p>
        </div>
        <div class="header-card">
            <h5>ğŸ”’ HSTS</h5>
            <p>Force l'utilisation de HTTPS</p>
        </div>
        <div class="header-card">
            <h5>ğŸ›¡ï¸ X-Content-Type-Options</h5>
            <p>PrÃ©vient le sniffing MIME</p>
        </div>
        <div class="header-card">
            <h5>ğŸ” Referrer-Policy</h5>
            <p>ContrÃ´le les informations de rÃ©fÃ©rent</p>
        </div>
    </div>
</div>

<h3>ğŸ”‘ Gestion des Tokens</h3>

<div class="security-section">
    <h4>ğŸ« Configuration JWT</h4>
    <div class="code-block">// DurÃ©es de vie optimisÃ©es pour la sÃ©curitÃ©
const ACCESS_TOKEN_EXPIRY = '15m';  // Court pour limiter l'exposition
const REFRESH_TOKEN_EXPIRY = '7d';  // Plus long pour l'ergonomie

class TokenService {
  static generateAccessToken(payload: any): string {
    return jwt.sign(payload, process.env.JWT_SECRET!, {
      expiresIn: ACCESS_TOKEN_EXPIRY,
      issuer: 'SuperOAuth',
      audience: 'SuperOAuth-Users'
    });
  }
}</div>

    <div class="token-security-features">
        <div class="feature-card">
            <div class="feature-icon">â±ï¸</div>
            <h5>DurÃ©e de Vie Courte</h5>
            <p>Access tokens expirent en 15 minutes</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">ğŸ”„</div>
            <h5>Rotation Automatique</h5>
            <p>Refresh tokens sont renouvelÃ©s Ã  chaque usage</p>
        </div>
        <div class="feature-card">
            <div class="feature-icon">ğŸš«</div>
            <h5>RÃ©vocation</h5>
            <p>Blacklist des tokens compromis</p>
        </div>
    </div>
</div>

<div class="security-section">
    <h4>ğŸ”„ Rotation des Tokens</h4>
    <div class="code-block">class RefreshTokenService {
  static async rotateTokens(refreshToken: string) {
    // VÃ©rifier et invalider l'ancien refresh token
    const payload = this.verifyRefreshToken(refreshToken);
    await this.revokeRefreshToken(refreshToken);
    
    // GÃ©nÃ©rer de nouveaux tokens
    const newAccessToken = TokenService.generateAccessToken(payload);
    const newRefreshToken = TokenService.generateRefreshToken(payload);
    
    return { accessToken: newAccessToken, refreshToken: newRefreshToken };
  }
}</div>
</div>

<h3>âœ… Validation et Sanitisation</h3>

<div class="security-section">
    <h4>ğŸ” Validation des EntrÃ©es</h4>
    <div class="code-block">import { IsEmail, IsString, MinLength, MaxLength } from 'class-validator';

class CreateUserDto {
  @IsEmail()
  email: string;

  @IsString()
  @MinLength(8)
  @MaxLength(128)
  password: string;

  @IsString()
  @MinLength(2)
  @MaxLength(50)
  nickname: string;
}</div>

    <div class="validation-rules">
        <h5>ğŸ“‹ RÃ¨gles de Validation</h5>
        <ul>
            <li><strong>Email</strong> : Format RFC valide obligatoire</li>
            <li><strong>Mot de passe</strong> : 8-128 caractÃ¨res avec complexitÃ©</li>
            <li><strong>Pseudo</strong> : 2-50 caractÃ¨res, alphanumÃ©riques</li>
            <li><strong>Sanitisation</strong> : Nettoyage automatique XSS</li>
        </ul>
    </div>
</div>

<h3>ğŸš¨ Monitoring et Logs</h3>

<div class="security-section">
    <h4>ğŸ“Š Logging de SÃ©curitÃ©</h4>
    <div class="code-block">class SecurityLogger {
  static logFailedLogin(email: string, ip: string) {
    securityLogger.warn('Failed login attempt', {
      email,
      ip,
      timestamp: new Date().toISOString(),
      event: 'FAILED_LOGIN'
    });
  }

  static logSuspiciousActivity(userId: string, activity: string) {
    securityLogger.error('Suspicious activity detected', {
      userId,
      activity,
      timestamp: new Date().toISOString(),
      event: 'SUSPICIOUS_ACTIVITY'
    });
  }
}</div>

    <div class="monitoring-events">
        <h5>ğŸ¯ Ã‰vÃ©nements SurveillÃ©s</h5>
        <div class="events-grid">
            <div class="event-card critical">
                <h6>ğŸš¨ Critiques</h6>
                <ul>
                    <li>Tentatives de connexion Ã©chouÃ©es</li>
                    <li>AccÃ¨s non autorisÃ©s</li>
                    <li>Manipulation de tokens</li>
                </ul>
            </div>
            <div class="event-card warning">
                <h6>âš ï¸ Avertissements</h6>
                <ul>
                    <li>Connexions inhabituelles</li>
                    <li>Changements de mot de passe</li>
                    <li>ActivitÃ© suspecte</li>
                </ul>
            </div>
            <div class="event-card info">
                <h6>â„¹ï¸ Informations</h6>
                <ul>
                    <li>Connexions rÃ©ussies</li>
                    <li>CrÃ©ation de comptes</li>
                    <li>Usage normal des API</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<h3>ğŸ› ï¸ Configuration SÃ©curisÃ©e</h3>

<div class="security-section">
    <h4>âš™ï¸ Variables d'Environnement</h4>
    <div class="code-block"># Secrets forts (gÃ©nÃ©rer avec openssl rand -base64 32)
JWT_SECRET=your_256_bit_secret_key_here
JWT_REFRESH_SECRET=your_different_256_bit_refresh_key

# Base de donnÃ©es avec utilisateur dÃ©diÃ©
DB_USERNAME=superoauth_user  # Pas root !
DB_PASSWORD=strong_random_password

# Configuration de production
NODE_ENV=production
CORS_ORIGIN=https://yourdomain.com</div>

    <div class="config-checklist">
        <h5>âœ… Checklist de Configuration</h5>
        <div class="checklist-grid">
            <div class="checklist-item">
                <span class="check">âœ…</span> Secrets de 256 bits minimum
            </div>
            <div class="checklist-item">
                <span class="check">âœ…</span> Utilisateur DB dÃ©diÃ© (non-root)
            </div>
            <div class="checklist-item">
                <span class="check">âœ…</span> CORS configurÃ© strictement
            </div>
            <div class="checklist-item">
                <span class="check">âœ…</span> Variables d'environnement sÃ©curisÃ©es
            </div>
            <div class="checklist-item">
                <span class="check">âœ…</span> HTTPS forcÃ© en production
            </div>
            <div class="checklist-item">
                <span class="check">âœ…</span> Rate limiting activÃ©
            </div>
        </div>
    </div>
</div>

<h3>ğŸ†˜ RÃ©ponse aux Incidents</h3>

<div class="security-section">
    <h4>ğŸš¨ Plan de RÃ©ponse</h4>
    <div class="incident-response">
        <div class="response-step">
            <div class="step-number">1</div>
            <div class="step-content">
                <h5>ğŸ” DÃ©tection</h5>
                <p>Monitoring automatique et alertes en temps rÃ©el</p>
            </div>
        </div>
        <div class="response-step">
            <div class="step-number">2</div>
            <div class="step-content">
                <h5>ğŸš« Isolation</h5>
                <p>Blocage automatique des comptes/IPs suspects</p>
            </div>
        </div>
        <div class="response-step">
            <div class="step-number">3</div>
            <div class="step-content">
                <h5>ğŸ”¬ Investigation</h5>
                <p>Analyse des logs et Ã©valuation de l'impact</p>
            </div>
        </div>
        <div class="response-step">
            <div class="step-number">4</div>
            <div class="step-content">
                <h5>ğŸ”§ RemÃ©diation</h5>
                <p>Correction des vulnÃ©rabilitÃ©s identifiÃ©es</p>
            </div>
        </div>
        <div class="response-step">
            <div class="step-number">5</div>
            <div class="step-content">
                <h5>ğŸ“¢ Communication</h5>
                <p>Notification des utilisateurs si nÃ©cessaire</p>
            </div>
        </div>
    </div>
</div>

<h3>ğŸ¯ Bonnes Pratiques</h3>

<div class="best-practices-grid">
    <div class="practice-card">
        <h4>ğŸ” Authentification</h4>
        <ul>
            <li>Mots de passe complexes obligatoires</li>
            <li>Hachage bcrypt avec salt Ã©levÃ©</li>
            <li>Rate limiting sur les endpoints sensibles</li>
            <li>Monitoring des tentatives d'intrusion</li>
        </ul>
    </div>
    
    <div class="practice-card">
        <h4>ğŸ« Gestion des Tokens</h4>
        <ul>
            <li>DurÃ©e de vie courte pour les access tokens</li>
            <li>Rotation systÃ©matique des refresh tokens</li>
            <li>RÃ©vocation en cas de compromission</li>
            <li>Signature forte avec secrets sÃ©parÃ©s</li>
        </ul>
    </div>
    
    <div class="practice-card">
        <h4>ğŸŒ SÃ©curitÃ© Web</h4>
        <ul>
            <li>CSP strict sans inline scripts</li>
            <li>Headers de sÃ©curitÃ© complets</li>
            <li>Validation stricte des entrÃ©es</li>
            <li>Sanitisation automatique XSS</li>
        </ul>
    </div>
    
    <div class="practice-card">
        <h4>ğŸ“Š Monitoring</h4>
        <ul>
            <li>Logging de tous les Ã©vÃ©nements sÃ©curitaires</li>
            <li>Alertes automatiques en temps rÃ©el</li>
            <li>Audit rÃ©gulier des accÃ¨s</li>
            <li>MÃ©triques de sÃ©curitÃ©</li>
        </ul>
    </div>
</div>

<div class="security-summary">
    <h4>ğŸ¯ RÃ©sumÃ© de la Posture SÃ©curitaire</h4>
    <p>SuperOAuth implÃ©mente une approche de sÃ©curitÃ© en profondeur avec de multiples couches de protection. L'architecture privilÃ©gie la sÃ©curitÃ© dÃ¨s la conception (Security by Design) tout en maintenant une expÃ©rience utilisateur fluide.</p>
    
    <div class="security-metrics">
        <div class="metric">
            <span class="metric-value">256-bit</span>
            <span class="metric-label">ClÃ©s de chiffrement</span>
        </div>
        <div class="metric">
            <span class="metric-value">15min</span>
            <span class="metric-label">DurÃ©e access token</span>
        </div>
        <div class="metric">
            <span class="metric-value">12 rounds</span>
            <span class="metric-label">Salt bcrypt</span>
        </div>
        <div class="metric">
            <span class="metric-value">5/15min</span>
            <span class="metric-label">Rate limiting</span>
        </div>
    </div>
</div>
